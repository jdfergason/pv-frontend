(self["webpackChunkpenny_vault"]=self["webpackChunkpenny_vault"]||[]).push([[357],{3821:(e,o,t)=>{"use strict";t.r(o),t.d(o,{default:()=>z});var a=t(5305);const l={class:"row q-col-gutter-md q-pl-sm"},r={class:"col-lg-6 col-sm-4"},n={class:"q-mt-sm q-mb-sm"},i={style:{"font-size":"1rem"}},s={class:"col-lg-6 col-sm-8 gt-xs self-end"},c={class:"row q-pl-sm"},d={class:"col"},m={class:"row xs"},p={class:"col"},u={class:"text-center q-ml-md q-mb-sm text-grey-6"};function f(e,o,t,f,v,g){const b=(0,a.resolveComponent)("q-tab"),V=(0,a.resolveComponent)("q-tabs"),y=(0,a.resolveComponent)("q-breadcrumbs-el"),h=(0,a.resolveComponent)("q-breadcrumbs"),N=(0,a.resolveComponent)("portfolio-summary"),C=(0,a.resolveComponent)("q-tab-panel"),q=(0,a.resolveComponent)("portfolio-holdings"),k=(0,a.resolveComponent)("portfolio-transactions"),S=(0,a.resolveComponent)("portfolio-returns"),w=(0,a.resolveComponent)("portfolio-settings"),P=(0,a.resolveComponent)("q-tab-panels"),x=(0,a.resolveComponent)("q-page");return(0,a.openBlock)(),(0,a.createBlock)(x,{class:"q-pa-xs"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)("div",l,[(0,a.createVNode)("div",r,[(0,a.createVNode)("h4",n,[(0,a.createTextVNode)((0,a.toDisplayString)(e.portfolio.name)+" ",1),(0,a.createVNode)("span",i,"("+(0,a.toDisplayString)(e.format(e.portfolio.performance.periodStart,"MMM"))+" '"+(0,a.toDisplayString)(e.format(e.portfolio.performance.periodStart,"yy"))+" to "+(0,a.toDisplayString)(e.format(e.portfolio.performance.periodEnd,"MMM"))+" '"+(0,a.toDisplayString)(e.format(e.portfolio.performance.periodEnd,"yy"))+")",1)])]),(0,a.createVNode)("div",s,[(0,a.createVNode)(V,{"inline-label":"","outside-arrows":"","mobile-arrows":"",align:"right","active-color":"blue","indicator-color":"blue",modelValue:e.tabModel,"onUpdate:modelValue":o[1]||(o[1]=o=>e.tabModel=o)},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(b,{name:"summary",label:"Summary"}),(0,a.createVNode)(b,{name:"holdings",label:"Holdings"}),(0,a.createVNode)(b,{name:"transactions",label:"Transactions"}),(0,a.createVNode)(b,{name:"returns",label:"Returns"}),(0,a.createVNode)(b,{name:"settings",label:"Settings"})])),_:1},8,["modelValue"])])]),(0,a.createVNode)("div",c,[(0,a.createVNode)("div",d,[(0,a.createVNode)(h,{class:"q-mb-lg"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(y,{icon:"home",to:"/app"}),(0,a.createVNode)(y,{label:"My Portfolios",to:"/app/portfolio"}),(0,a.createVNode)(y,{label:e.portfolio.name},null,8,["label"])])),_:1})])]),(0,a.createVNode)("div",m,[(0,a.createVNode)("div",p,[(0,a.createVNode)(V,{dense:"","inside-arrows":"",align:"right","active-color":"blue","indicator-color":"blue",modelValue:e.tabModel,"onUpdate:modelValue":o[2]||(o[2]=o=>e.tabModel=o)},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(b,{name:"summary",label:"Summary"}),(0,a.createVNode)(b,{name:"holdings",label:"Holdings"}),(0,a.createVNode)(b,{name:"transactions",label:"Transactions"}),(0,a.createVNode)(b,{name:"returns",label:"Returns"}),(0,a.createVNode)(b,{name:"settings",label:"Settings"})])),_:1},8,["modelValue"])])]),(0,a.createVNode)(P,{class:"transparent",modelValue:e.tabModel,"onUpdate:modelValue":o[3]||(o[3]=o=>e.tabModel=o),animated:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(C,{name:"summary"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(N)])),_:1}),(0,a.createVNode)(C,{name:"holdings"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(q)])),_:1}),(0,a.createVNode)(C,{name:"transactions"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(k)])),_:1}),(0,a.createVNode)(C,{name:"returns"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(S)])),_:1}),(0,a.createVNode)(C,{name:"settings"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(w,{"portfolio-id":e.portfolioId},null,8,["portfolio-id"])])),_:1})])),_:1},8,["modelValue"]),(0,a.createVNode)("span",u,"Computed on: "+(0,a.toDisplayString)(e.format(e.portfolio.performance.computedOn,"eeee, MMM eo yyyy HH:mm:ss")),1)])),_:1})}var v=t(7874),g=t(4240),b=t(6454),V=t(1052);const y=(0,a.createVNode)("h6",{class:"q-mb-none q-mt-lg"},"Email status frequency",-1),h={class:"q-pt-lg"};function N(e,o,t,l,r,n){const i=(0,a.resolveComponent)("q-input"),s=(0,a.resolveComponent)("q-toggle"),c=(0,a.resolveComponent)("q-btn"),d=(0,a.resolveComponent)("q-form");return(0,a.openBlock)(),(0,a.createBlock)(d,{ref:"params",onSubmit:e.onSubmit,class:"q-gutter-md"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(i,{modelValue:e.name,"onUpdate:modelValue":o[1]||(o[1]=o=>e.name=o),label:"Portfolio Name"},null,8,["modelValue"]),(0,a.createVNode)("div",null,[y,((0,a.openBlock)(!0),(0,a.createBlock)(a.Fragment,null,(0,a.renderList)(e.notifications,(e=>((0,a.openBlock)(),(0,a.createBlock)(s,{class:"q-mr-lg",key:e.text,modelValue:e.state,"onUpdate:modelValue":o=>e.state=o,label:e.text},null,8,["modelValue","onUpdate:modelValue","label"])))),128))]),(0,a.createVNode)("div",h,[(0,a.createVNode)(c,{label:"Save",type:"submit",color:"info"}),(0,a.createVNode)(c,{label:"Delete",color:"negative",class:"q-ml-sm",onClick:e.deletePortfolio},null,8,["onClick"])])])),_:1},8,["onSubmit"])}t(5363);var C=t(9582),q=t(8825),k=t(7641),S=t(5474),w=t(4929);const P=(0,a.defineComponent)({name:"PortfolioSettings",props:{portfolioId:{type:String,required:!0}},setup(e,o){const t=(0,v.oR)(),l=(0,q.Z)(),r=(0,C.tv)(),n=(0,a.computed)((()=>t.state.portfolio.current)),i=(0,a.ref)(!1),s=(0,a.ref)(`${n.value.name}`),c=(0,a.ref)({daily:{text:"Daily",value:w.FP,state:!1},weekly:{text:"Weekly",value:w.Qs,state:!1},monthly:{text:"Monthly",value:w.EA,state:!1},annually:{text:"Annually",value:w.DL,state:!1}});function d(){console.log("unpackNotifications"),c.value.daily.state=(n.value.notifications&w.FP)==w.FP,c.value.weekly.state=(n.value.notifications&w.Qs)==w.Qs,c.value.monthly.state=(n.value.notifications&w.EA)==w.EA,c.value.annually.state=(n.value.notifications&w.DL)==w.DL}function m(){var e=w.mP;return Object.keys(c.value).forEach((o=>{c.value[o].state&&(e|=c.value[o].value)})),e}async function p(e){e.preventDefault();var o=m();t.commit("portfolio/setNotifications",o),t.commit("portfolio/setPortfolioName",s.value);var a={name:s.value,notifications:o};f(a)}async function u(){k.bE.getTokenSilently().then((o=>{l.dialog({title:"Confirm",message:"Please confirm that you want to delete this portfolio.",cancel:!0,persistent:!0}).onOk((()=>{S.api.delete("/portfolio/"+e.portfolioId,{headers:{Authorization:`Bearer ${o}`}}).then((({data:e})=>{l.notify({message:"Deleted portfolio",progress:!0,color:"positive",icon:"check_circle",position:"top"}),t.dispatch("portfolio/fetchPortfolios"),r.replace("/app/portfolio/")})).catch((e=>{l.notify({message:`Failed to delete portfolio settings: ${e}`,progress:!0,color:"negative",icon:"error",position:"top"})}))}))}))}function f(o){k.bE.getTokenSilently().then((a=>{S.api.patch("/portfolio/"+e.portfolioId,o,{headers:{Authorization:`Bearer ${a}`}}).then((({data:e})=>{l.notify({message:`Saved portfolio settings: ${e.name} (${e.id})`,progress:!0,color:"positive",icon:"check_circle",position:"top"}),t.dispatch("portfolio/fetchPortfolios")})).catch((e=>{l.notify({message:`Failed to save portfolio settings: ${e}`,progress:!0,color:"negative",icon:"error",position:"top"})}))}))}return(0,a.onMounted)((()=>{d()})),(0,a.watch)(n,(()=>{s.value=n.value.name,d()})),{confirm:i,deletePortfolio:u,name:s,notifications:c,onSubmit:p,portfolio:n}}});var x=t(5269),M=t(4842),Z=t(8886),_=t(2165),Q=t(7518),B=t.n(Q);P.render=N;const D=P;B()(P,"components",{QForm:x.Z,QInput:M.Z,QToggle:Z.Z,QBtn:_.Z});var T=t(8257),E=t(6472);const I=(0,a.defineComponent)({name:"Portfolio",props:{portfolioId:String},components:{PortfolioHoldings:b.Z,PortfolioReturns:V.Z,PortfolioSettings:D,PortfolioSummary:T.Z,PortfolioTransactions:E.Z},setup(e){const o=(0,v.oR)(),{portfolioId:t}=(0,a.toRefs)(e),l=(0,a.ref)("summary");o.dispatch("portfolio/fetchPortfolio",e.portfolioId),(0,a.watch)(t,(async(e,t)=>{o.dispatch("portfolio/fetchPortfolio",e)}));const r=(0,a.computed)((()=>o.state.portfolio.current));return{format:g.Z,portfolio:r,tabModel:l}}});var F=t(4379),$=t(7547),A=t(3269),R=t(1481),U=t(5926),H=t(5906),L=t(6602);I.render=f;const z=I;B()(I,"components",{QPage:F.Z,QTabs:$.Z,QTab:A.Z,QBreadcrumbs:R.Z,QBreadcrumbsEl:U.Z,QTabPanels:H.Z,QTabPanel:L.Z})}}]);